<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kubernetes Ingress Provider | Traefik</title>
    <meta name="description" content="Traefik Documentation">
    
    
    <link rel="preload" href="/traefik/assets/css/0.styles.ff21fc36.css" as="style"><link rel="preload" href="/traefik/assets/js/app.ae787784.js" as="script"><link rel="preload" href="/traefik/assets/js/17.7c01ac03.js" as="script"><link rel="prefetch" href="/traefik/assets/js/10.d9f32ac0.js"><link rel="prefetch" href="/traefik/assets/js/11.375b726e.js"><link rel="prefetch" href="/traefik/assets/js/12.9acb0324.js"><link rel="prefetch" href="/traefik/assets/js/13.8f411b20.js"><link rel="prefetch" href="/traefik/assets/js/14.5aa54c49.js"><link rel="prefetch" href="/traefik/assets/js/15.18320535.js"><link rel="prefetch" href="/traefik/assets/js/16.f386789a.js"><link rel="prefetch" href="/traefik/assets/js/18.3c97b5d1.js"><link rel="prefetch" href="/traefik/assets/js/19.1483f0a7.js"><link rel="prefetch" href="/traefik/assets/js/2.f0fe713b.js"><link rel="prefetch" href="/traefik/assets/js/20.0485452d.js"><link rel="prefetch" href="/traefik/assets/js/21.f2312fc4.js"><link rel="prefetch" href="/traefik/assets/js/22.ee03f9ff.js"><link rel="prefetch" href="/traefik/assets/js/23.647e2047.js"><link rel="prefetch" href="/traefik/assets/js/24.e91ab9c9.js"><link rel="prefetch" href="/traefik/assets/js/25.6d2905c1.js"><link rel="prefetch" href="/traefik/assets/js/26.6b0b7881.js"><link rel="prefetch" href="/traefik/assets/js/27.a1e67edd.js"><link rel="prefetch" href="/traefik/assets/js/28.858e5d66.js"><link rel="prefetch" href="/traefik/assets/js/29.26643758.js"><link rel="prefetch" href="/traefik/assets/js/3.c340e227.js"><link rel="prefetch" href="/traefik/assets/js/30.e4524922.js"><link rel="prefetch" href="/traefik/assets/js/31.cb24e220.js"><link rel="prefetch" href="/traefik/assets/js/32.d475b1ed.js"><link rel="prefetch" href="/traefik/assets/js/33.f84e04da.js"><link rel="prefetch" href="/traefik/assets/js/34.bbe37568.js"><link rel="prefetch" href="/traefik/assets/js/35.2c01db0b.js"><link rel="prefetch" href="/traefik/assets/js/36.308bc37c.js"><link rel="prefetch" href="/traefik/assets/js/37.5d1dbe7b.js"><link rel="prefetch" href="/traefik/assets/js/38.9377ad2b.js"><link rel="prefetch" href="/traefik/assets/js/39.e1a55eef.js"><link rel="prefetch" href="/traefik/assets/js/4.90ba113d.js"><link rel="prefetch" href="/traefik/assets/js/40.eea6044f.js"><link rel="prefetch" href="/traefik/assets/js/5.fae081a3.js"><link rel="prefetch" href="/traefik/assets/js/6.a2ec5521.js"><link rel="prefetch" href="/traefik/assets/js/7.3779a4fa.js"><link rel="prefetch" href="/traefik/assets/js/8.58f6dd40.js"><link rel="prefetch" href="/traefik/assets/js/9.96dc80cc.js">
    <link rel="stylesheet" href="/traefik/assets/css/0.styles.ff21fc36.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/traefik/" class="home-link router-link-active"><!----> <span class="site-name">Traefik</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/traefik/" class="sidebar-link">Getting Started</a></li><li><a href="/traefik/basics.html" class="sidebar-link">Basics</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Configuration</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/traefik/configuration/commons.html" class="sidebar-link">Commons</a></li><li><a href="/traefik/configuration/logs.html" class="sidebar-link">Logs</a></li><li><a href="/traefik/configuration/entrypoints.html" class="sidebar-link">EntryPoints</a></li><li><a href="/traefik/configuration/acme.html" class="sidebar-link">Let's Encrypt</a></li><li><a href="/traefik/configuration/api.html" class="sidebar-link">API / Dashboard</a></li><li><a href="/traefik/configuration/backends/boltdb.html" class="sidebar-link">BoltDB</a></li><li><a href="/traefik/configuration/backends/consul.html" class="sidebar-link">Consul</a></li><li><a href="/traefik/configuration/backends/consulcatalog.html" class="sidebar-link">Consul Catalog</a></li><li><a href="/traefik/configuration/backends/docker.html" class="sidebar-link">Docker</a></li><li><a href="/traefik/configuration/backends/dynamodb.html" class="sidebar-link">DynamoDB</a></li><li><a href="/traefik/configuration/backends/ecs.html" class="sidebar-link">ECS</a></li><li><a href="/traefik/configuration/backends/etcd.html" class="sidebar-link">Etcd</a></li><li><a href="/traefik/configuration/backends/eureka.html" class="sidebar-link">Eureka</a></li><li><a href="/traefik/configuration/backends/file.html" class="sidebar-link">File</a></li><li><a href="/traefik/configuration/backends/kubernetes.html" class="active sidebar-link">Kubernetes Ingress</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/traefik/configuration/backends/kubernetes.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/traefik/configuration/backends/kubernetes.html#annotations" class="sidebar-link">Annotations</a></li></ul></li><li><a href="/traefik/configuration/backends/marathon.html" class="sidebar-link">Marathon</a></li><li><a href="/traefik/configuration/backends/mesos.html" class="sidebar-link">Mesos</a></li><li><a href="/traefik/configuration/backends/rancher.html" class="sidebar-link">Rancher</a></li><li><a href="/traefik/configuration/backends/rest.html" class="sidebar-link">Rest</a></li><li><a href="/traefik/configuration/backends/servicefabric.html" class="sidebar-link">Azure Service Fabric</a></li><li><a href="/traefik/configuration/backends/zookeeper.html" class="sidebar-link">Zookeeper</a></li><li><a href="/traefik/configuration/ping.html" class="sidebar-link">Ping</a></li><li><a href="/traefik/configuration/metrics.html" class="sidebar-link">Metrics</a></li><li><a href="/traefik/configuration/tracing.html" class="sidebar-link">Tracing</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>User Guides</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="kubernetes-ingress-provider"><a href="#kubernetes-ingress-provider" aria-hidden="true" class="header-anchor">#</a> Kubernetes Ingress Provider</h1> <p>Traefik can be configured to use Kubernetes Ingress as a provider.</p> <p>See also <a href="/user-guide/kubernetes">Kubernetes user guide</a>.</p> <h2 id="configuration"><a href="#configuration" aria-hidden="true" class="header-anchor">#</a> Configuration</h2> <div class="language-ini extra-class"><pre class="language-ini"><code>################################################################
# Kubernetes Ingress Provider
################################################################

# Enable Kubernetes Ingress Provider.
<span class="token selector">[kubernetes]</span>

# Kubernetes server endpoint.
#
# Optional for in-cluster configuration, required otherwise.
# Default: empty
#
# endpoint <span class="token attr-value"><span class="token punctuation">=</span> &quot;http://localhost:8080&quot;</span>

# Bearer token used for the Kubernetes client configuration.
#
# Optional
# Default: empty
#
# token <span class="token attr-value"><span class="token punctuation">=</span> &quot;my token&quot;</span>

# Path to the certificate authority file.
# Used for the Kubernetes client configuration.
#
# Optional
# Default: empty
#
# certAuthFilePath <span class="token attr-value"><span class="token punctuation">=</span> &quot;/my/ca.crt&quot;</span>

# Array of namespaces to watch.
#
# Optional
# Default: all namespaces (empty array).
#
# namespaces <span class="token attr-value"><span class="token punctuation">=</span> [&quot;default&quot;, &quot;production&quot;]</span>

# Ingress label selector to filter Ingress objects that should be processed.
#
# Optional
# Default: empty (process all Ingresses)
#
# labelselector <span class="token attr-value"><span class="token punctuation">=</span> &quot;A and not B&quot;</span>

# Value of `kubernetes.io/ingress.class` annotation that identifies Ingress objects to be processed.
# If the parameter is non-empty, only Ingresses containing an annotation with the same value are processed.
# Otherwise, Ingresses missing the annotation, having an empty value, or the value `traefik` are processed.
#
# Optional
# Default: empty
#
# ingressClass <span class="token attr-value"><span class="token punctuation">=</span> &quot;traefik-internal&quot;</span>

# Disable PassHost Headers.
#
# Optional
# Default: false
#
# disablePassHostHeaders <span class="token attr-value"><span class="token punctuation">=</span> true</span>

# Enable PassTLSCert Headers.
#
# Optional
# Default: false
#
# enablePassTLSCert <span class="token attr-value"><span class="token punctuation">=</span> true</span>

# Override default configuration template.
#
# Optional
# Default: &lt;built-in template&gt;
#
# filename <span class="token attr-value"><span class="token punctuation">=</span> &quot;kubernetes.tmpl&quot;</span>

# Enable IngressEndpoint configuration.
# This will allow Traefik to update the status section of ingress objects, if desired.
#
# Optional
#
# [kubernetes.ingressEndpoint]
#
# At least one must be configured.
# `publishedservice` will override the `hostname` and `ip` settings if configured.
#
# hostname <span class="token attr-value"><span class="token punctuation">=</span> &quot;localhost&quot;</span>
# ip <span class="token attr-value"><span class="token punctuation">=</span> &quot;127.0.0.1&quot;</span>
# publishedService <span class="token attr-value"><span class="token punctuation">=</span> &quot;namespace/servicename&quot;</span>
</code></pre></div><h3 id="endpoint"><a href="#endpoint" aria-hidden="true" class="header-anchor">#</a> <code>endpoint</code></h3> <p>The Kubernetes server endpoint as URL.</p> <p>When deployed into Kubernetes, Traefik will read the environment variables <code>KUBERNETES_SERVICE_HOST</code> and <code>KUBERNETES_SERVICE_PORT</code> to construct the endpoint.</p> <p>The access token will be looked up in <code>/var/run/secrets/kubernetes.io/serviceaccount/token</code> and the SSL CA certificate in <code>/var/run/secrets/kubernetes.io/serviceaccount/ca.crt</code>.
Both are provided mounted automatically when deployed inside Kubernetes.</p> <p>The endpoint may be specified to override the environment variable values inside a cluster.</p> <p>When the environment variables are not found, Traefik will try to connect to the Kubernetes API server with an external-cluster client.
In this case, the endpoint is required.
Specifically, it may be set to the URL used by <code>kubectl proxy</code> to connect to a Kubernetes cluster using the granted authentication and authorization of the associated kubeconfig.</p> <h3 id="labelselector"><a href="#labelselector" aria-hidden="true" class="header-anchor">#</a> <code>labelselector</code></h3> <p>By default, Traefik processes all Ingress objects in the configured namespaces.
A label selector can be defined to filter on specific Ingress objects only.</p> <p>See <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors" target="_blank" rel="noopener noreferrer">label-selectors<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for details.</p> <h3 id="ingressendpoint"><a href="#ingressendpoint" aria-hidden="true" class="header-anchor">#</a> <code>ingressEndpoint</code></h3> <p>You can configure a static hostname or IP address that Traefik will add to the status section of Ingress objects that it manages.
If you prefer, you can provide a service, which traefik will copy the status spec from.
This will give more flexibility in cloud/dynamic environments.</p> <h3 id="tls-communication-between-traefik-and-backend-pods"><a href="#tls-communication-between-traefik-and-backend-pods" aria-hidden="true" class="header-anchor">#</a> TLS communication between Traefik and backend pods</h3> <p>Traefik automatically requests endpoint information based on the service provided in the ingress spec.
Although traefik will connect directly to the endpoints (pods), it still checks the service port to see if TLS communication is required.</p> <p>There are 3 ways to configure Traefik to use https to communicate with backend pods:</p> <ol><li>If the service port defined in the ingress spec is 443 (note that you can still use <code>targetPort</code> to use a different port on your pod).</li> <li>If the service port defined in the ingress spec has a name that starts with <code>https</code> (such as <code>https-api</code>, <code>https-web</code> or just <code>https</code>).</li> <li>If the ingress spec includes the annotation <code>ingress.kubernetes.io/protocol: https</code>.</li></ol> <p>If either of those configuration options exist, then the backend communication protocol is assumed to be TLS, and will connect via TLS automatically.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Please note that by enabling TLS communication between traefik and your pods, you will have to have trusted certificates that have the proper trust chain and IP subject name.
If this is not an option, you may need to skip TLS certificate verification.
See the <a href="/traefik/configuration/commons/#main-section">insecureSkipVerify</a> setting for more details.</p></div> <h2 id="annotations"><a href="#annotations" aria-hidden="true" class="header-anchor">#</a> Annotations</h2> <h3 id="general-annotations"><a href="#general-annotations" aria-hidden="true" class="header-anchor">#</a> General annotations</h3> <p>The following general annotations are applicable on the Ingress object:</p> <table><thead><tr><th>Annotation</th> <th>Description</th></tr></thead> <tbody><tr><td><code>traefik.ingress.kubernetes.io/app-root: &quot;/index.html&quot;</code></td> <td>Redirects all requests for <code>/</code> to the defined path. (1)</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/error-pages: &lt;YML&gt;</code></td> <td>See <a href="/traefik/configuration/commons/#custom-error-pages">custom error pages</a> section. (2)</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/frontend-entry-points: http,https</code></td> <td>Override the default frontend endpoints.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/pass-client-tls-cert: &lt;YML&gt;</code></td> <td>Forward the client certificate following the configuration in YAML. (3)</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/pass-tls-cert: &quot;true&quot;</code></td> <td>Override the default frontend PassTLSCert value. Default: <code>false</code>.(DEPRECATED)</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/preserve-host: &quot;true&quot;</code></td> <td>Forward client <code>Host</code> header to the backend.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/priority: &quot;3&quot;</code></td> <td>Override the default frontend rule priority.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/rate-limit: &lt;YML&gt;</code></td> <td>See <a href="/traefik/configuration/commons/#rate-limiting">rate limiting</a> section. (4)</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/redirect-entry-point: https</code></td> <td>Enables Redirect to another entryPoint for that frontend (e.g. HTTPS).</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/redirect-permanent: &quot;true&quot;</code></td> <td>Return 301 instead of 302.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/redirect-regex: ^http://localhost/(.*)</code></td> <td>Redirect to another URL for that frontend. Must be set with <code>traefik.ingress.kubernetes.io/redirect-replacement</code>.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/redirect-replacement: http://mydomain/$1</code></td> <td>Redirect to another URL for that frontend. Must be set with <code>traefik.ingress.kubernetes.io/redirect-regex</code>.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/request-modifier: AddPrefix: /users</code></td> <td>Adds a <a href="/traefik/basics/#modifiers">request modifier</a> to the backend request.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/rewrite-target: /users</code></td> <td>Replaces each matched Ingress path with the specified one, and adds the old path to the <code>X-Replaced-Path</code> header.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/rule-type: PathPrefixStrip</code></td> <td>Overrides the default frontend rule type. Only path-related matchers can be specified <a href="/traefik/basics/#path-matcher-usage-guidelines">(<code>Path</code>, <code>PathPrefix</code>, <code>PathStrip</code>, <code>PathPrefixStrip</code>)</a>.(5)</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/request-modifier: AddPrefix: /users</code></td> <td>Add a <a href="/traefik/basics/#modifiers">request modifier</a> to the backend request.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/service-weights: &lt;YML&gt;</code></td> <td>Set ingress backend weights specified as percentage or decimal numbers in YAML. (6)</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/whitelist-source-range: &quot;1.2.3.0/24, fe80::/16&quot;</code></td> <td>A comma-separated list of IP ranges permitted for access (7).</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/whiteList-ipstrategy=true</code></td> <td>Uses the default IPStrategy.<br>Can be used when there is an existing <code>clientIPStrategy</code> but you want the remote address for whitelisting.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/whiteList-ipstrategy-depth=5</code></td> <td>See <a href="/traefik/configuration/entrypoints/#white-listing">whitelist</a></td></tr> <tr><td><code>traefik.ingress.kubernetes.io/whiteList-ipstrategy-excludedIPs=127.0.0. 1</code></td> <td>See <a href="/traefik/configuration/entrypoints/#white-listing">whitelist</a></td></tr> <tr><td><code>ingress.kubernetes.io/protocol: &lt;NAME&gt;</code></td> <td>Set the protocol Traefik will use to communicate with pods. Acceptable protocols: http,https,h2c</td></tr></tbody></table> <p>&lt;1&gt; <code>traefik.ingress.kubernetes.io/app-root</code>:
Non-root paths will not be affected by this annotation and handled normally.
This annotation may not be combined with other redirect annotations.
Trying to do so will result in the other redirects being ignored.
This annotation can be used in combination with <code>traefik.ingress.kubernetes.io/redirect-permanent</code> to configure whether the <code>app-root</code> redirect is a 301 or a 302.</p> <p>&lt;2&gt; <code>traefik.ingress.kubernetes.io/error-pages</code> example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">foo</span><span class="token punctuation">:</span>
  <span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;404&quot;</span>
  <span class="token key atrule">backend</span><span class="token punctuation">:</span> bar
  <span class="token key atrule">query</span><span class="token punctuation">:</span> /bar
<span class="token key atrule">fii</span><span class="token punctuation">:</span>
  <span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;503&quot;</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;500&quot;</span>
  <span class="token key atrule">backend</span><span class="token punctuation">:</span> bar
  <span class="token key atrule">query</span><span class="token punctuation">:</span> /bir
</code></pre></div><p>&lt;3&gt; <code>traefik.ingress.kubernetes.io/pass-client-tls-cert</code> example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># add escaped pem in the `X-Forwarded-Tls-Client-Cert` header</span>
<span class="token key atrule">pem</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment"># add escaped certificate following infos in the `X-Forwarded-Tls-Client-Cert-Infos` header</span>
<span class="token key atrule">infos</span><span class="token punctuation">:</span>
  <span class="token key atrule">notafter</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">notbefore</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">sans</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">subject</span><span class="token punctuation">:</span>
    <span class="token key atrule">country</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">province</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">locality</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">organization</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">commonname</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">serialnumber</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre></div><p>If <code>pem</code> is set, it will add a <code>X-Forwarded-Tls-Client-Cert</code> header that contains the escaped pem as value.<br>
If at least one flag of the <code>infos</code> part is set, it will add a <code>X-Forwarded-Tls-Client-Cert-Infos</code> header that contains an escaped string composed of the client certificate data selected by the infos flags.
This infos part is composed like the following example (not escaped):
<code>Subject=&quot;C=FR,ST=SomeState,L=Lyon,O=Cheese,CN=*.cheese.org&quot;,NB=1531900816,NA=1563436816,SAN=*.cheese.org,*.cheese.net,cheese.in,test@cheese.org,test@cheese.net,10.0.1.0,10.0.1.2</code></p> <p>&lt;4&gt; <code>traefik.ingress.kubernetes.io/rate-limit</code> example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">extractorfunc</span><span class="token punctuation">:</span> client.ip
<span class="token key atrule">rateset</span><span class="token punctuation">:</span>
  <span class="token key atrule">bar</span><span class="token punctuation">:</span>
    <span class="token key atrule">period</span><span class="token punctuation">:</span> 3s
    <span class="token key atrule">average</span><span class="token punctuation">:</span> <span class="token number">6</span>
    <span class="token key atrule">burst</span><span class="token punctuation">:</span> <span class="token number">9</span>
  <span class="token key atrule">foo</span><span class="token punctuation">:</span>
    <span class="token key atrule">period</span><span class="token punctuation">:</span> 6s
    <span class="token key atrule">average</span><span class="token punctuation">:</span> <span class="token number">12</span>
    <span class="token key atrule">burst</span><span class="token punctuation">:</span> <span class="token number">18</span>
</code></pre></div><p>&lt;5&gt; <code>traefik.ingress.kubernetes.io/rule-type</code>
Note: <code>ReplacePath</code> is deprecated in this annotation, use the <code>traefik.ingress.kubernetes.io/request-modifier</code> annotation instead. Default: <code>PathPrefix</code>.</p> <p>&lt;6&gt; <code>traefik.ingress.kubernetes.io/service-weights</code>:
Service weights enable to split traffic across multiple backing services in a fine-grained manner.</p> <p>Example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">service_backend1</span><span class="token punctuation">:</span> 12.50%
<span class="token key atrule">service_backend2</span><span class="token punctuation">:</span> 12.50%
<span class="token key atrule">service_backend3</span><span class="token punctuation">:</span> <span class="token number">75 </span><span class="token comment"># Same as 75%, the percentage sign is optional</span>
</code></pre></div><p>A single service backend definition may be omitted; in this case, Traefik auto-completes that service backend to 100% automatically.
Conveniently, users need not bother to compute the percentage remainder for a main service backend.
For instance, in the example above <code>service_backend3</code> does not need to be specified to be assigned 75%.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <pre><code>For each service weight given, the Ingress specification must include a backend item with the corresponding `serviceName` and (if given) matching path.
</code></pre></div> <p>Currently, 3 decimal places for the weight are supported.
An attempt to exceed the precision should be avoided as it may lead to percentage computation flaws and, in consequence, Ingress parsing errors.</p> <p>For each path definition, this annotation will fail if:</p> <ul><li>the sum of backend weights exceeds 100% or</li> <li>the sum of backend weights is less than 100% without one or more omitted backends</li></ul> <p>See also the <a href="/traefik/user-guide/kubernetes/#traffic-splitting">user guide section traffic splitting</a>.</p> <p>&lt;7&gt; <code>traefik.ingress.kubernetes.io/whitelist-source-range</code>:
All source IPs are permitted if the list is empty or a single range is ill-formatted.
Please note, you may have to set <code>service.spec.externalTrafficPolicy</code> to the value <code>Local</code> to preserve the source IP of the request for filtering.
Please see <a href="https://kubernetes.io/docs/tutorials/services/source-ip/" target="_blank" rel="noopener noreferrer">this link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for more information.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <pre><code>Please note that `traefik.ingress.kubernetes.io/redirect-regex` and `traefik.ingress.kubernetes.io/redirect-replacement` do not have to be set if `traefik.ingress.kubernetes.io/redirect-entry-point` is defined for the redirection (they will not be used in this case).
</code></pre></div> <p>The following annotations are applicable on the Service object associated with a particular Ingress object:</p> <table><thead><tr><th>Annotation</th> <th>Description</th></tr></thead> <tbody><tr><td><code>traefik.ingress.kubernetes.io/buffering: &lt;YML&gt;</code></td> <td>(1) See the <a href="/traefik/configuration/commons/#buffering">buffering</a> section.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/affinity: &quot;true&quot;</code></td> <td>Enable backend sticky sessions.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/circuit-breaker-expression: &lt;expression&gt;</code></td> <td>Set the circuit breaker expression for the backend.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/responseforwarding-flushinterval: &quot;10ms</code></td> <td>Defines the interval between two flushes when forwarding response from backend to client.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/load-balancer-method: drr</code></td> <td>Override the default <code>wrr</code> load balancer algorithm.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/max-conn-amount: &quot;10&quot;</code></td> <td>Sets the maximum number of simultaneous connections to the backend.<br>Must be used in conjunction with the label below to take effect.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/max-conn-extractor-func: client.ip</code></td> <td>Set the function to be used against the request to determine what to limit maximum connections to the backend by.<br>Must be used in conjunction with the above label to take effect.</td></tr> <tr><td><code>traefik.ingress.kubernetes.io/session-cookie-name: &lt;NAME&gt;</code></td> <td>Manually set the cookie name for sticky sessions.</td></tr></tbody></table> <p>&lt;1&gt; <code>traefik.ingress.kubernetes.io/buffering</code> example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">maxrequestbodybytes</span><span class="token punctuation">:</span> <span class="token number">10485760</span>
<span class="token key atrule">memrequestbodybytes</span><span class="token punctuation">:</span> <span class="token number">2097153</span>
<span class="token key atrule">maxresponsebodybytes</span><span class="token punctuation">:</span> <span class="token number">10485761</span>
<span class="token key atrule">memresponsebodybytes</span><span class="token punctuation">:</span> <span class="token number">2097152</span>
<span class="token key atrule">retryexpression</span><span class="token punctuation">:</span> IsNetworkError() &amp;&amp; Attempts() &lt;= 2
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <pre><code>`traefik.ingress.kubernetes.io/` and `ingress.kubernetes.io/` are supported prefixes.
</code></pre></div> <h3 id="custom-headers-annotations"><a href="#custom-headers-annotations" aria-hidden="true" class="header-anchor">#</a> Custom Headers Annotations</h3> <table><thead><tr><th>Annotation</th> <th>Description</th></tr></thead> <tbody><tr><td><code>ingress.kubernetes.io/custom-request-headers: EXPR</code></td> <td>Provides the container with custom request headers that will be appended to each request forwarded to the container. Format: <code>HEADER:value||HEADER2:value2</code></td></tr> <tr><td><code>ingress.kubernetes.io/custom-response-headers: EXPR</code></td> <td>Appends the headers to each response returned by the container, before forwarding the response to the client. Format: <code>HEADER:value||HEADER2:value2</code></td></tr></tbody></table> <h3 id="security-headers-annotations"><a href="#security-headers-annotations" aria-hidden="true" class="header-anchor">#</a> Security Headers Annotations</h3> <p>The following security annotations are applicable on the Ingress object:</p> <table><thead><tr><th>Annotation</th> <th>Description</th></tr></thead> <tbody><tr><td><code>ingress.kubernetes.io/allowed-hosts: EXPR</code></td> <td>Provides a list of allowed hosts that requests will be processed. Format: <code>Host1,Host2</code></td></tr> <tr><td><code>ingress.kubernetes.io/browser-xss-filter: &quot;true&quot;</code></td> <td>Adds the X-XSS-Protection header with the value <code>1; mode=block</code>.</td></tr> <tr><td><code>ingress.kubernetes.io/content-security-policy: VALUE</code></td> <td>Adds CSP Header with the custom value.</td></tr> <tr><td><code>ingress.kubernetes.io/content-type-nosniff: &quot;true&quot;</code></td> <td>Adds the <code>X-Content-Type-Options</code> header with the value <code>nosniff</code>.</td></tr> <tr><td><code>ingress.kubernetes.io/custom-browser-xss-value: VALUE</code></td> <td>Set custom value for X-XSS-Protection header. This overrides the BrowserXssFilter option.</td></tr> <tr><td><code>ingress.kubernetes.io/custom-frame-options-value: VALUE</code></td> <td>Overrides the <code>X-Frame-Options</code> header with the custom value.</td></tr> <tr><td><code>ingress.kubernetes.io/force-hsts: &quot;false&quot;</code></td> <td>Adds the STS  header to non-SSL requests.</td></tr> <tr><td><code>ingress.kubernetes.io/frame-deny: &quot;true&quot;</code></td> <td>Adds the <code>X-Frame-Options</code> header with the value of <code>DENY</code>.</td></tr> <tr><td><code>ingress.kubernetes.io/hsts-max-age: &quot;315360000&quot;</code></td> <td>Sets the max-age of the HSTS header.</td></tr> <tr><td><code>ingress.kubernetes.io/hsts-include-subdomains: &quot;true&quot;</code></td> <td>Adds the IncludeSubdomains section of the STS  header.</td></tr> <tr><td><code>ingress.kubernetes.io/hsts-preload: &quot;true&quot;</code></td> <td>Adds the preload flag to the HSTS  header.</td></tr> <tr><td><code>ingress.kubernetes.io/is-development: &quot;false&quot;</code></td> <td>This will cause the <code>AllowedHosts</code>, <code>SSLRedirect</code>, and <code>STSSeconds</code>/<code>STSIncludeSubdomains</code> options to be ignored during development.<br>When deploying to production, be sure to set this to false.</td></tr> <tr><td><code>ingress.kubernetes.io/proxy-headers: EXPR</code></td> <td>Provides a list of headers that the proxied hostname may be stored. Format:  <code>HEADER1,HEADER2</code></td></tr> <tr><td><code>ingress.kubernetes.io/public-key: VALUE</code></td> <td>Adds HPKP header.</td></tr> <tr><td><code>ingress.kubernetes.io/referrer-policy: VALUE</code></td> <td>Adds referrer policy  header.</td></tr> <tr><td><code>ingress.kubernetes.io/ssl-redirect: &quot;true&quot;</code></td> <td>Forces the frontend to redirect to SSL if a non-SSL request is sent.</td></tr> <tr><td><code>ingress.kubernetes.io/ssl-temporary-redirect: &quot;true&quot;</code></td> <td>Forces the frontend to redirect to SSL if a non-SSL request is sent, but by sending a 302 instead of a 301.</td></tr> <tr><td><code>ingress.kubernetes.io/ssl-host: HOST</code></td> <td>This setting configures the hostname that redirects will be based on. Default is &quot;&quot;, which is the same host as the request.</td></tr> <tr><td><code>ingress.kubernetes.io/ssl-force-host: &quot;true&quot;</code></td> <td>If <code>SSLForceHost</code> is <code>true</code> and <code>SSLHost</code> is set, requests will be forced to use <code>SSLHost</code> even the ones that are already using SSL. Default is false.</td></tr> <tr><td><code>ingress.kubernetes.io/ssl-proxy-headers: EXPR</code></td> <td>Header combinations that would signify a proper SSL Request (Such as <code>X-Forwarded-For:https</code>). Format: <code>HEADER:value||HEADER2:value2</code></td></tr></tbody></table> <h3 id="authentication"><a href="#authentication" aria-hidden="true" class="header-anchor">#</a> Authentication</h3> <p>Additional authentication annotations can be added to the Ingress object.
The source of the authentication is a Secret object that contains the credentials.</p> <table><thead><tr><th>Annotation</th> <th>basic</th> <th>digest</th> <th>forward</th> <th>Description</th></tr></thead> <tbody><tr><td><code>ingress.kubernetes.io/auth-type: basic</code></td> <td>x</td> <td>x</td> <td>x</td> <td>Contains the authentication type: <code>basic</code>, <code>digest</code>, <code>forward</code>.</td></tr> <tr><td><code>ingress.kubernetes.io/auth-secret: mysecret</code></td> <td>x</td> <td>x</td> <td></td> <td>Name of Secret containing the username and password with access to the paths defined in the Ingress object.</td></tr> <tr><td><code>ingress.kubernetes.io/auth-remove-header: true</code></td> <td>x</td> <td>x</td> <td></td> <td>If set to <code>true</code> removes the <code>Authorization</code> header.</td></tr> <tr><td><code>ingress.kubernetes.io/auth-header-field: X-WebAuth-User</code></td> <td>x</td> <td>x</td> <td></td> <td>Pass Authenticated user to application via headers.</td></tr> <tr><td><code>ingress.kubernetes.io/auth-url: https://example.com</code></td> <td></td> <td></td> <td>x</td> <td><a href="/traefik/configuration/entrypoints/#forward-authentication">The URL of the authentication server</a>.</td></tr> <tr><td><code>ingress.kubernetes.io/auth-trust-headers: false</code></td> <td></td> <td></td> <td>x</td> <td>Trust <code>X-Forwarded-*</code> headers.</td></tr> <tr><td><code>ingress.kubernetes.io/auth-response-headers: X-Auth-User, X-Secret</code></td> <td></td> <td></td> <td>x</td> <td>Copy headers from the authentication server to the request.</td></tr> <tr><td><code>ingress.kubernetes.io/auth-tls-secret: secret</code></td> <td></td> <td></td> <td>x</td> <td>Name of Secret containing the certificate and key for the forward auth.</td></tr> <tr><td><code>ingress.kubernetes.io/auth-tls-insecure</code></td> <td></td> <td></td> <td>x</td> <td>If set to <code>true</code> invalid SSL certificates are accepted.</td></tr></tbody></table> <p>The secret must be created in the same namespace as the Ingress object.</p> <p>The following limitations hold for basic/digest auth:</p> <ul><li>The realm is not configurable; the only supported (and default) value is <code>traefik</code>.</li> <li>The Secret must contain a single file only.</li></ul> <h3 id="tls-certificates-management"><a href="#tls-certificates-management" aria-hidden="true" class="header-anchor">#</a> TLS certificates management</h3> <p>TLS certificates can be managed in Secrets objects.
More information are available in the  <a href="/traefik/user-guide/kubernetes/#add-a-tls-certificate-to-the-ingress">User Guide</a>.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <pre><code>Only TLS certificates provided by users can be stored in Kubernetes Secrets.
[Let's Encrypt](https://letsencrypt.org) certificates cannot be managed in Kubernets Secrets yet.
</code></pre></div> <h3 id="global-default-backend-ingresses"><a href="#global-default-backend-ingresses" aria-hidden="true" class="header-anchor">#</a> Global Default Backend Ingresses</h3> <p>Ingresses can be created that look like the following:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> cheese
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">backend</span><span class="token punctuation">:</span>
    <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> stilton
    <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><p>This ingress follows the <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/#the-ingress-resource" target="_blank" rel="noopener noreferrer">Global Default Backend<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> property of ingresses.
This will allow users to create a &quot;default backend&quot; that will match all unmatched requests.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <pre><code>Due to Traefik's use of priorities, you may have to set this ingress priority lower than other ingresses in your environment, to avoid this global ingress from satisfying requests that _could_ match other ingresses.
To do this, use the `traefik.ingress.kubernetes.io/priority` annotation (as seen in [General Annotations](/configuration/backends/kubernetes/#general-annotations)) on your ingresses accordingly.
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/traefik/configuration/backends/file.html" class="prev">
          File
        </a></span> <span class="next"><a href="/traefik/configuration/backends/marathon.html">
          Marathon
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/traefik/assets/js/app.ae787784.js" defer></script><script src="/traefik/assets/js/17.7c01ac03.js" defer></script>
  </body>
</html>
